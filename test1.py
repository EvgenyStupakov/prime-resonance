import math
import cmath

FROM = 1
TO = 100

K_MAX = 200
sigma = 0.002551280340399997
threshold = 0.2

# первые 100 нетривиальных нулей Римана (воображаемые части)
zeros = [
    14.134725141734693, 21.022039638771554, 25.010857580145688,
    30.424876125859513, 32.935061587739197, 37.586178158825671,
    40.918719012147495, 43.327073280914999, 48.005150881167159,
    49.773832477672302, 52.970321477714548, 56.446247697063394,
    59.347044002602026, 60.831778524609810, 65.112544048081924,
    67.079810529494173, 69.546401711173979, 72.067157674481907,
    75.704690699083933, 77.144840068874305, 79.337375020249760,
    82.910380854086183, 84.735492980517028, 87.425274613125229,
    90.388057274512695, 92.545842342968957, 94.651344040519754,
    95.870634228245219, 98.831194218193474, 101.31785100554587,
    103.72553804080832, 105.44662305232677, 107.16861118427630,
    110.36455086541168, 111.45116379464543, 114.16197065381265,
    116.26562534782472, 118.79078286597663, 121.37012500297691,
    122.94682929368719, 124.25681855434578, 127.51668387949104,
    129.57870411384729, 131.08768853022310, 133.49773743908231,
    134.75650975322159, 138.11604210613044, 139.73620895253583,
    141.12370720436966, 143.11184552169824, 146.00098244938863,
    147.42276534003495, 150.11181121163550, 150.92525743450932,
    153.02469393393733, 156.14702518757033, 157.68995020967742,
    158.84998854734591, 161.18896493830629, 163.03070968765418,
    165.53711540555525, 167.18454933623635, 168.22970530605661,
    171.04954372589922, 172.31412722106167, 174.75419110331329,
    176.44143418213886, 178.33890661834730, 179.91088951833141,
    182.20707848461960, 184.87446773170433, 185.59895719494427,
    187.91686205722465, 189.38531471752693, 192.02665621081473,
    193.11113116265153, 195.30309049796441, 197.08020054740905,
    198.40696397112364, 201.26474159164504, 202.49338560569338,
    205.17932158672460, 206.31317671354118, 208.83083972904401,
    210.26890472676884, 212.05464772550705, 213.34782495032721,
    215.49333415956561, 218.13372910731234, 219.26501640359104,
    221.43032717739890, 223.04314731095774, 225.07379897673616,
    226.70347898399406, 228.17250321232357, 230.25079424192322,
    231.89748712208534, 233.69321288991992, 236.52422904586403
]

def von_mangoldt(n):
    if n < 2: return 0
    temp = n
    p = 2
    while p * p <= temp:
        power = 0
        while temp % p == 0:
            temp //= p
            power += 1
        if power > 0:
            return math.log(p)
        p += 1
    if temp > 1:
        return math.log(temp)
    return 0

def is_prime(n):
    if n < 2: return False
    for i in range(2, int(math.isqrt(n)) + 1):
        if n % i == 0: return False
    return True

def resonance(n):
    total = 0+0j
    for t in zeros:
        s = complex(sigma, t)
        for k in range(1, K_MAX+1):
            Λ = von_mangoldt(k)
            if Λ == 0: continue
            total += Λ / (k**s) * cmath.exp(1j * n * math.log(k))
    return abs(total)

resonant = []
true_primes = []

for n in range(FROM, TO+1):
    R = resonance(n)
    if R > threshold:
        resonant.append(n)
    if is_prime(n):
        true_primes.append(n)

correct = [n for n in resonant if is_prime(n)]
false = [n for n in resonant if not is_prime(n)]

print("Prime:", correct)

